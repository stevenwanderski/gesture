Gesture = {};

$(function(){

  window.scrollTo(0, 0);

  Gesture.slider = Swipe(document.getElementById('slider'), {
    callback: slide_callback,
    continuous: false,
    disableScroll: true
  });

  $('[data-control="next"]').click(function(e) {
    e.preventDefault();
    Gesture.slider.next();
  });

  $('[data-control="prev"]').click(function(e) {
    e.preventDefault();
    Gesture.slider.prev();
  });

  $('.slide img').load(function(){
    $('.loader').fadeOut(500);
  });

});

function slide_callback(e){
  var current_index = Gesture.slider.getPos();
  var next_el = $('.slide').eq(current_index + 1);
  if(next_el.find('img').length == 0){
    load_image(next_el, current_index + 1);
  }
}

function load_image(el, index){
  var image_url = Gesture.poses[index].image.url;
  var image = $('<img />').attr('src', image_url);
  image.load(function(){
    el.html(image);
  });
}